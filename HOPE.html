<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>HOPE Hospital Management System</title>
<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@600;700&family=Source+Sans+3:wght@300;400;600;700&display=swap" rel="stylesheet"/>
<style>
  :root {
    --blue-deep: #0a3d6b;
    --blue-mid: #1565c0;
    --blue-light: #1e88e5;
    --blue-pale: #e3f0fc;
    --blue-accent: #42a5f5;
    --white: #ffffff;
    --gray-light: #f4f7fb;
    --gray-mid: #b0bec5;
    --gray-dark: #37474f;
    --success: #2e7d32;
    --warning: #e65100;
    --red: #c62828;
  }

  * { box-sizing: border-box; margin: 0; padding: 0; }

  body {
    font-family: 'Source Sans 3', sans-serif;
    font-size: 18px;
    background: var(--gray-light);
    color: var(--gray-dark);
    min-height: 100vh;
  }

  /* ‚îÄ‚îÄ SIDEBAR ‚îÄ‚îÄ */
  #sidebar {
    position: fixed; top: 0; left: 0;
    width: 270px; height: 100vh;
    background: var(--blue-deep);
    display: flex; flex-direction: column;
    z-index: 100;
    box-shadow: 4px 0 20px rgba(0,0,0,0.18);
  }

  .sidebar-logo {
    padding: 32px 24px 24px;
    border-bottom: 1px solid rgba(255,255,255,0.1);
  }
  .sidebar-logo h1 {
    font-family: 'Playfair Display', serif;
    color: var(--white);
    font-size: 2rem;
    letter-spacing: 2px;
  }
  .sidebar-logo p {
    color: var(--blue-accent);
    font-size: 0.85rem;
    letter-spacing: 1px;
    margin-top: 4px;
  }

  .sidebar-nav { flex: 1; padding: 20px 0; overflow-y: auto; }

  .nav-section-label {
    color: var(--gray-mid);
    font-size: 0.72rem;
    letter-spacing: 2px;
    text-transform: uppercase;
    padding: 16px 24px 6px;
  }

  .nav-btn {
    display: flex; align-items: center; gap: 14px;
    width: 100%; padding: 14px 24px;
    background: none; border: none;
    color: rgba(255,255,255,0.75);
    font-size: 1rem;
    font-family: 'Source Sans 3', sans-serif;
    cursor: pointer;
    transition: all 0.2s;
    text-align: left;
  }
  .nav-btn:hover { background: rgba(255,255,255,0.08); color: var(--white); }
  .nav-btn.active {
    background: var(--blue-light);
    color: var(--white);
    border-left: 4px solid var(--blue-accent);
  }
  .nav-btn .icon { font-size: 1.3rem; min-width: 26px; }

  .sidebar-footer {
    padding: 20px 24px;
    border-top: 1px solid rgba(255,255,255,0.1);
    color: rgba(255,255,255,0.5);
    font-size: 0.85rem;
  }

  /* ‚îÄ‚îÄ MAIN CONTENT ‚îÄ‚îÄ */
  #main {
    margin-left: 270px;
    min-height: 100vh;
    display: flex; flex-direction: column;
  }

  #topbar {
    background: var(--white);
    padding: 18px 36px;
    display: flex; align-items: center; justify-content: space-between;
    box-shadow: 0 2px 8px rgba(0,0,0,0.06);
    position: sticky; top: 0; z-index: 50;
  }
  #topbar h2 {
    font-family: 'Playfair Display', serif;
    color: var(--blue-deep);
    font-size: 1.6rem;
  }
  .topbar-right {
    display: flex; align-items: center; gap: 18px;
  }
  .topbar-date {
    color: var(--gray-mid);
    font-size: 0.9rem;
  }
  .avatar {
    width: 44px; height: 44px; border-radius: 50%;
    background: var(--blue-light);
    color: white; display: flex; align-items: center; justify-content: center;
    font-weight: 700; font-size: 1rem;
    cursor: pointer;
  }

  #content { padding: 32px 36px; flex: 1; }

  /* ‚îÄ‚îÄ PAGES ‚îÄ‚îÄ */
  .page { display: none; animation: fadeIn 0.3s ease; }
  .page.active { display: block; }
  @keyframes fadeIn { from { opacity: 0; transform: translateY(8px); } to { opacity: 1; transform: translateY(0); } }

  /* ‚îÄ‚îÄ CARDS ‚îÄ‚îÄ */
  .stats-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 20px; margin-bottom: 32px;
  }
  .stat-card {
    background: var(--white);
    border-radius: 16px;
    padding: 24px;
    box-shadow: 0 2px 12px rgba(0,0,0,0.06);
    border-left: 5px solid var(--blue-light);
    transition: transform 0.2s;
  }
  .stat-card:hover { transform: translateY(-3px); }
  .stat-card .stat-icon { font-size: 2rem; margin-bottom: 10px; }
  .stat-card .stat-num {
    font-size: 2.2rem; font-weight: 700;
    color: var(--blue-deep);
    font-family: 'Playfair Display', serif;
  }
  .stat-card .stat-label { color: var(--gray-mid); font-size: 0.95rem; margin-top: 4px; }

  /* ‚îÄ‚îÄ TABLES ‚îÄ‚îÄ */
  .card {
    background: var(--white);
    border-radius: 16px;
    padding: 28px;
    box-shadow: 0 2px 12px rgba(0,0,0,0.06);
    margin-bottom: 28px;
  }
  .card-title {
    font-family: 'Playfair Display', serif;
    color: var(--blue-deep);
    font-size: 1.3rem;
    margin-bottom: 20px;
    display: flex; align-items: center; justify-content: space-between;
  }

  table { width: 100%; border-collapse: collapse; }
  thead th {
    background: var(--blue-pale);
    color: var(--blue-deep);
    font-weight: 700;
    padding: 14px 16px;
    text-align: left;
    font-size: 0.95rem;
    letter-spacing: 0.5px;
  }
  thead th:first-child { border-radius: 8px 0 0 8px; }
  thead th:last-child { border-radius: 0 8px 8px 0; }
  tbody tr { border-bottom: 1px solid #eef2f7; transition: background 0.15s; }
  tbody tr:hover { background: var(--blue-pale); }
  tbody td { padding: 14px 16px; font-size: 1rem; }

  /* ‚îÄ‚îÄ BADGES ‚îÄ‚îÄ */
  .badge {
    display: inline-block;
    padding: 4px 14px; border-radius: 20px;
    font-size: 0.85rem; font-weight: 600;
  }
  .badge-green { background: #e8f5e9; color: var(--success); }
  .badge-blue { background: var(--blue-pale); color: var(--blue-mid); }
  .badge-orange { background: #fff3e0; color: var(--warning); }
  .badge-red { background: #ffebee; color: var(--red); }

  /* ‚îÄ‚îÄ BUTTONS ‚îÄ‚îÄ */
  .btn {
    padding: 12px 24px; border-radius: 10px; border: none;
    font-size: 1rem; font-family: 'Source Sans 3', sans-serif;
    cursor: pointer; font-weight: 600; transition: all 0.2s;
    display: inline-flex; align-items: center; gap: 8px;
  }
  .btn-primary { background: var(--blue-light); color: white; }
  .btn-primary:hover { background: var(--blue-mid); transform: translateY(-1px); }
  .btn-outline {
    background: transparent; color: var(--blue-light);
    border: 2px solid var(--blue-light);
  }
  .btn-outline:hover { background: var(--blue-pale); }
  .btn-danger { background: var(--red); color: white; }
  .btn-danger:hover { background: #b71c1c; }
  .btn-sm { padding: 8px 16px; font-size: 0.9rem; }

  /* ‚îÄ‚îÄ FORMS ‚îÄ‚îÄ */
  .form-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
    gap: 20px;
  }
  .form-group { display: flex; flex-direction: column; gap: 8px; }
  .form-group label {
    font-weight: 600; color: var(--blue-deep); font-size: 1rem;
  }
  .form-group input,
  .form-group select,
  .form-group textarea {
    padding: 13px 16px;
    border: 2px solid #dce6f4;
    border-radius: 10px;
    font-size: 1rem;
    font-family: 'Source Sans 3', sans-serif;
    transition: border 0.2s;
    background: var(--white);
  }
  .form-group input:focus,
  .form-group select:focus,
  .form-group textarea:focus {
    outline: none;
    border-color: var(--blue-light);
    box-shadow: 0 0 0 3px rgba(30,136,229,0.12);
  }
  .form-group textarea { min-height: 100px; resize: vertical; }

  /* ‚îÄ‚îÄ MODAL ‚îÄ‚îÄ */
  .modal-overlay {
    display: none; position: fixed; inset: 0;
    background: rgba(0,0,0,0.45); z-index: 200;
    align-items: center; justify-content: center;
  }
  .modal-overlay.open { display: flex; }
  .modal {
    background: white; border-radius: 20px;
    padding: 36px; width: 90%; max-width: 640px;
    max-height: 90vh; overflow-y: auto;
    box-shadow: 0 20px 60px rgba(0,0,0,0.2);
    animation: fadeIn 0.25s ease;
  }
  .modal-title {
    font-family: 'Playfair Display', serif;
    color: var(--blue-deep); font-size: 1.5rem;
    margin-bottom: 24px;
  }
  .modal-actions { display: flex; gap: 12px; margin-top: 28px; justify-content: flex-end; }

  /* ‚îÄ‚îÄ SEARCH ‚îÄ‚îÄ */
  .search-bar {
    display: flex; gap: 12px; margin-bottom: 20px; flex-wrap: wrap;
  }
  .search-bar input {
    flex: 1; min-width: 200px;
    padding: 12px 18px; border: 2px solid #dce6f4;
    border-radius: 10px; font-size: 1rem;
    font-family: 'Source Sans 3', sans-serif;
  }
  .search-bar input:focus { outline: none; border-color: var(--blue-light); }

  /* ‚îÄ‚îÄ TOAST ‚îÄ‚îÄ */
  #toast {
    position: fixed; bottom: 32px; right: 32px;
    background: var(--blue-deep); color: white;
    padding: 16px 28px; border-radius: 12px;
    font-size: 1rem; font-weight: 600;
    box-shadow: 0 8px 24px rgba(0,0,0,0.2);
    transform: translateY(80px); opacity: 0;
    transition: all 0.35s cubic-bezier(.4,0,.2,1);
    z-index: 500;
  }
  #toast.show { transform: translateY(0); opacity: 1; }

  /* ‚îÄ‚îÄ WELCOME BANNER ‚îÄ‚îÄ */
  .welcome-banner {
    background: linear-gradient(135deg, var(--blue-deep), var(--blue-light));
    border-radius: 20px; padding: 36px;
    color: white; margin-bottom: 28px;
    position: relative; overflow: hidden;
  }
  .welcome-banner::after {
    content: 'üè•';
    position: absolute; right: 40px; top: 50%;
    transform: translateY(-50%);
    font-size: 5rem; opacity: 0.15;
  }
  .welcome-banner h2 {
    font-family: 'Playfair Display', serif;
    font-size: 1.8rem; margin-bottom: 8px;
  }
  .welcome-banner p { opacity: 0.85; font-size: 1.05rem; }

  /* Responsive */
  @media (max-width: 768px) {
    #sidebar { width: 0; overflow: hidden; }
    #main { margin-left: 0; }
  }
</style>
</head>
<body>

<!-- SIDEBAR -->
<nav id="sidebar">
  <div class="sidebar-logo">
    <h1>HOPE</h1>
    <p>HOSPITAL MANAGEMENT</p>
  </div>
  <div class="sidebar-nav">
    <div class="nav-section-label">Main</div>
    <button class="nav-btn active" onclick="showPage('dashboard', this)">
      <span class="icon">üè†</span> Dashboard
    </button>

    <div class="nav-section-label">Patients</div>
    <button class="nav-btn" onclick="showPage('patients', this)">
      <span class="icon">üë§</span> Patient Records
    </button>
    <button class="nav-btn" onclick="showPage('appointments', this)">
      <span class="icon">üìÖ</span> Appointments
    </button>

    <div class="nav-section-label">Hospital</div>
    <button class="nav-btn" onclick="showPage('staff', this)">
      <span class="icon">üë®‚Äç‚öïÔ∏è</span> Doctors & Staff
    </button>
    <button class="nav-btn" onclick="showPage('billing', this)">
      <span class="icon">üí≥</span> Billing & Payments
    </button>
  </div>
  <div class="sidebar-footer">
    ¬© 2025 HOPE Hospital
  </div>
</nav>

<!-- MAIN -->
<div id="main">
  <div id="topbar">
    <h2 id="page-title">Dashboard</h2>
    <div class="topbar-right">
      <span class="topbar-date" id="current-date"></span>
      <div class="avatar" title="Admin">AD</div>
    </div>
  </div>

  <div id="content">

    <!-- ‚ïê‚ïê DASHBOARD ‚ïê‚ïê -->
    <div class="page active" id="page-dashboard">
      <div class="welcome-banner">
        <h2>Good Morning, Admin üëã</h2>
        <p>Here's what's happening at HOPE Hospital today.</p>
      </div>
      <div class="stats-grid">
        <div class="stat-card">
          <div class="stat-icon">üë§</div>
          <div class="stat-num" id="stat-patients">0</div>
          <div class="stat-label">Total Patients</div>
        </div>
        <div class="stat-card" style="border-color:#2e7d32">
          <div class="stat-icon">üìÖ</div>
          <div class="stat-num" id="stat-appts">0</div>
          <div class="stat-label">Appointments Today</div>
        </div>
        <div class="stat-card" style="border-color:#6a1b9a">
          <div class="stat-icon">üë®‚Äç‚öïÔ∏è</div>
          <div class="stat-num" id="stat-staff">0</div>
          <div class="stat-label">Doctors & Staff</div>
        </div>
        <div class="stat-card" style="border-color:#e65100">
          <div class="stat-icon">üí≥</div>
          <div class="stat-num" id="stat-billing">‚Çπ0</div>
          <div class="stat-label">Revenue This Month</div>
        </div>
      </div>

      <div class="card">
        <div class="card-title">Recent Appointments</div>
        <table>
          <thead><tr>
            <th>Patient</th><th>Doctor</th><th>Date</th><th>Status</th>
          </tr></thead>
          <tbody id="dash-appts-table">
            <tr><td colspan="4" style="text-align:center;color:var(--gray-mid);padding:24px">No appointments yet. Add some!</td></tr>
          </tbody>
        </table>
      </div>
    </div>

    <!-- ‚ïê‚ïê PATIENTS ‚ïê‚ïê -->
    <div class="page" id="page-patients">
      <div class="search-bar">
        <input type="text" id="patient-search" placeholder="üîç  Search patient by name or ID..." oninput="renderPatients()"/>
        <button class="btn btn-primary" onclick="openModal('modal-patient')">‚ûï  Add New Patient</button>
      </div>
      <div class="card">
        <div class="card-title">Patient Records</div>
        <table>
          <thead><tr>
            <th>ID</th><th>Name</th><th>Age</th><th>Gender</th><th>Phone</th><th>Blood Group</th><th>Status</th><th>Actions</th>
          </tr></thead>
          <tbody id="patients-table"></tbody>
        </table>
      </div>
    </div>

    <!-- ‚ïê‚ïê APPOINTMENTS ‚ïê‚ïê -->
    <div class="page" id="page-appointments">
      <div class="search-bar">
        <input type="text" id="appt-search" placeholder="üîç  Search by patient or doctor..." oninput="renderAppointments()"/>
        <button class="btn btn-primary" onclick="openModal('modal-appt')">‚ûï  Book Appointment</button>
      </div>
      <div class="card">
        <div class="card-title">All Appointments</div>
        <table>
          <thead><tr>
            <th>ID</th><th>Patient</th><th>Doctor</th><th>Date</th><th>Time</th><th>Reason</th><th>Status</th><th>Actions</th>
          </tr></thead>
          <tbody id="appts-table"></tbody>
        </table>
      </div>
    </div>

    <!-- ‚ïê‚ïê STAFF ‚ïê‚ïê -->
    <div class="page" id="page-staff">
      <div class="search-bar">
        <input type="text" id="staff-search" placeholder="üîç  Search staff..." oninput="renderStaff()"/>
        <button class="btn btn-primary" onclick="openModal('modal-staff')">‚ûï  Add Staff Member</button>
      </div>
      <div class="card">
        <div class="card-title">Doctors & Staff Directory</div>
        <table>
          <thead><tr>
            <th>ID</th><th>Name</th><th>Role</th><th>Department</th><th>Phone</th><th>Available</th><th>Actions</th>
          </tr></thead>
          <tbody id="staff-table"></tbody>
        </table>
      </div>
    </div>

    <!-- ‚ïê‚ïê BILLING ‚ïê‚ïê -->
    <div class="page" id="page-billing">
      <div class="search-bar">
        <input type="text" id="bill-search" placeholder="üîç  Search billing records..." oninput="renderBilling()"/>
        <button class="btn btn-primary" onclick="openModal('modal-bill')">‚ûï  Create Bill</button>
      </div>
      <div class="card">
        <div class="card-title">Billing & Payments</div>
        <table>
          <thead><tr>
            <th>Bill ID</th><th>Patient</th><th>Date</th><th>Services</th><th>Amount</th><th>Status</th><th>Actions</th>
          </tr></thead>
          <tbody id="billing-table"></tbody>
        </table>
      </div>
    </div>

  </div><!-- /content -->
</div><!-- /main -->

<!-- ‚ïê‚ïê TOAST ‚ïê‚ïê -->
<div id="toast"></div>

<!-- ‚ïê‚ïê MODAL: PATIENT ‚ïê‚ïê -->
<div class="modal-overlay" id="modal-patient">
  <div class="modal">
    <div class="modal-title">üë§ Add New Patient</div>
    <div class="form-grid">
      <div class="form-group"><label>Full Name *</label><input id="p-name" type="text" placeholder="e.g. Rajesh Kumar"/></div>
      <div class="form-group"><label>Age *</label><input id="p-age" type="number" placeholder="e.g. 45" min="0" max="150"/></div>
      <div class="form-group"><label>Gender</label>
        <select id="p-gender"><option>Male</option><option>Female</option><option>Other</option></select>
      </div>
      <div class="form-group"><label>Phone Number *</label><input id="p-phone" type="tel" placeholder="e.g. 9876543210"/></div>
      <div class="form-group"><label>Blood Group</label>
        <select id="p-blood"><option>A+</option><option>A-</option><option>B+</option><option>B-</option><option>O+</option><option>O-</option><option>AB+</option><option>AB-</option><option>Unknown</option></select>
      </div>
      <div class="form-group"><label>Status</label>
        <select id="p-status"><option>Active</option><option>Admitted</option><option>Discharged</option></select>
      </div>
      <div class="form-group" style="grid-column:1/-1">
        <label>Address</label><textarea id="p-address" placeholder="Full address..."></textarea>
      </div>
    </div>
    <div class="modal-actions">
      <button class="btn btn-outline" onclick="closeModal('modal-patient')">Cancel</button>
      <button class="btn btn-primary" onclick="addPatient()">‚úÖ  Save Patient</button>
    </div>
  </div>
</div>

<!-- ‚ïê‚ïê MODAL: APPOINTMENT ‚ïê‚ïê -->
<div class="modal-overlay" id="modal-appt">
  <div class="modal">
    <div class="modal-title">üìÖ Book Appointment</div>
    <div class="form-grid">
      <div class="form-group"><label>Patient Name *</label><input id="a-patient" type="text" placeholder="Patient name"/></div>
      <div class="form-group"><label>Doctor *</label><input id="a-doctor" type="text" placeholder="Doctor name"/></div>
      <div class="form-group"><label>Date *</label><input id="a-date" type="date"/></div>
      <div class="form-group"><label>Time *</label><input id="a-time" type="time"/></div>
      <div class="form-group" style="grid-column:1/-1">
        <label>Reason / Symptoms</label>
        <textarea id="a-reason" placeholder="Describe the reason for visit..."></textarea>
      </div>
    </div>
    <div class="modal-actions">
      <button class="btn btn-outline" onclick="closeModal('modal-appt')">Cancel</button>
      <button class="btn btn-primary" onclick="addAppointment()">‚úÖ  Book Appointment</button>
    </div>
  </div>
</div>

<!-- ‚ïê‚ïê MODAL: STAFF ‚ïê‚ïê -->
<div class="modal-overlay" id="modal-staff">
  <div class="modal">
    <div class="modal-title">üë®‚Äç‚öïÔ∏è Add Staff Member</div>
    <div class="form-grid">
      <div class="form-group"><label>Full Name *</label><input id="s-name" type="text" placeholder="e.g. Dr. Priya Sharma"/></div>
      <div class="form-group"><label>Role *</label>
        <select id="s-role"><option>Doctor</option><option>Nurse</option><option>Receptionist</option><option>Lab Technician</option><option>Pharmacist</option><option>Admin</option></select>
      </div>
      <div class="form-group"><label>Department *</label>
        <select id="s-dept"><option>General</option><option>Cardiology</option><option>Orthopedics</option><option>Pediatrics</option><option>Neurology</option><option>Gynecology</option><option>Emergency</option><option>Radiology</option></select>
      </div>
      <div class="form-group"><label>Phone</label><input id="s-phone" type="tel" placeholder="Contact number"/></div>
      <div class="form-group"><label>Availability</label>
        <select id="s-avail"><option>Available</option><option>On Duty</option><option>On Leave</option></select>
      </div>
    </div>
    <div class="modal-actions">
      <button class="btn btn-outline" onclick="closeModal('modal-staff')">Cancel</button>
      <button class="btn btn-primary" onclick="addStaff()">‚úÖ  Save Staff</button>
    </div>
  </div>
</div>

<!-- ‚ïê‚ïê MODAL: BILLING ‚ïê‚ïê -->
<div class="modal-overlay" id="modal-bill">
  <div class="modal">
    <div class="modal-title">üí≥ Create Bill</div>
    <div class="form-grid">
      <div class="form-group"><label>Patient Name *</label><input id="b-patient" type="text" placeholder="Patient name"/></div>
      <div class="form-group"><label>Date</label><input id="b-date" type="date"/></div>
      <div class="form-group" style="grid-column:1/-1">
        <label>Services Rendered</label>
        <input id="b-services" type="text" placeholder="e.g. Consultation, X-Ray, Blood Test"/>
      </div>
      <div class="form-group"><label>Total Amount (‚Çπ) *</label><input id="b-amount" type="number" placeholder="e.g. 2500" min="0"/></div>
      <div class="form-group"><label>Payment Status</label>
        <select id="b-status"><option>Paid</option><option>Pending</option><option>Partial</option></select>
      </div>
    </div>
    <div class="modal-actions">
      <button class="btn btn-outline" onclick="closeModal('modal-bill')">Cancel</button>
      <button class="btn btn-primary" onclick="addBill()">‚úÖ  Save Bill</button>
    </div>
  </div>
</div>

<script>
// ‚îÄ‚îÄ DATA STORE ‚îÄ‚îÄ
let patients = JSON.parse(localStorage.getItem('hms_patients') || '[]');
let appointments = JSON.parse(localStorage.getItem('hms_appts') || '[]');
let staff = JSON.parse(localStorage.getItem('hms_staff') || '[]');
let billing = JSON.parse(localStorage.getItem('hms_billing') || '[]');

let pCounter = parseInt(localStorage.getItem('hms_pc') || '1000');
let aCounter = parseInt(localStorage.getItem('hms_ac') || '2000');
let sCounter = parseInt(localStorage.getItem('hms_sc') || '3000');
let bCounter = parseInt(localStorage.getItem('hms_bc') || '4000');

function save() {
  localStorage.setItem('hms_patients', JSON.stringify(patients));
  localStorage.setItem('hms_appts', JSON.stringify(appointments));
  localStorage.setItem('hms_staff', JSON.stringify(staff));
  localStorage.setItem('hms_billing', JSON.stringify(billing));
  localStorage.setItem('hms_pc', pCounter);
  localStorage.setItem('hms_ac', aCounter);
  localStorage.setItem('hms_sc', sCounter);
  localStorage.setItem('hms_bc', bCounter);
}

// ‚îÄ‚îÄ NAVIGATION ‚îÄ‚îÄ
function showPage(page, btn) {
  document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
  document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
  document.getElementById('page-' + page).classList.add('active');
  if (btn) btn.classList.add('active');
  const titles = {dashboard:'Dashboard', patients:'Patient Records', appointments:'Appointments', staff:'Doctors & Staff', billing:'Billing & Payments'};
  document.getElementById('page-title').textContent = titles[page] || page;
  if (page === 'dashboard') updateDashboard();
  if (page === 'patients') renderPatients();
  if (page === 'appointments') renderAppointments();
  if (page === 'staff') renderStaff();
  if (page === 'billing') renderBilling();
}

// ‚îÄ‚îÄ MODAL ‚îÄ‚îÄ
function openModal(id) { document.getElementById(id).classList.add('open'); }
function closeModal(id) { document.getElementById(id).classList.remove('open'); }
document.querySelectorAll('.modal-overlay').forEach(m => {
  m.addEventListener('click', e => { if (e.target === m) m.classList.remove('open'); });
});

// ‚îÄ‚îÄ TOAST ‚îÄ‚îÄ
function toast(msg) {
  const t = document.getElementById('toast');
  t.textContent = msg; t.classList.add('show');
  setTimeout(() => t.classList.remove('show'), 2800);
}

// ‚îÄ‚îÄ DATE ‚îÄ‚îÄ
function updateDate() {
  const now = new Date();
  document.getElementById('current-date').textContent = now.toLocaleDateString('en-IN', {weekday:'long', year:'numeric', month:'long', day:'numeric'});
}
updateDate();

// ‚îÄ‚îÄ BADGE HELPERS ‚îÄ‚îÄ
function statusBadge(s) {
  const map = {
    'Active':'badge-green','Admitted':'badge-blue','Discharged':'badge-orange',
    'Paid':'badge-green','Pending':'badge-red','Partial':'badge-orange',
    'Available':'badge-green','On Duty':'badge-blue','On Leave':'badge-orange',
    'Scheduled':'badge-blue','Completed':'badge-green','Cancelled':'badge-red'
  };
  return `<span class="badge ${map[s]||'badge-blue'}">${s}</span>`;
}

// ‚îÄ‚îÄ DASHBOARD ‚îÄ‚îÄ
function updateDashboard() {
  document.getElementById('stat-patients').textContent = patients.length;
  const today = new Date().toISOString().split('T')[0];
  const todayAppts = appointments.filter(a => a.date === today);
  document.getElementById('stat-appts').textContent = todayAppts.length;
  document.getElementById('stat-staff').textContent = staff.length;
  const revenue = billing.filter(b => b.status === 'Paid').reduce((s,b) => s + Number(b.amount), 0);
  document.getElementById('stat-billing').textContent = '‚Çπ' + revenue.toLocaleString('en-IN');

  const tbody = document.getElementById('dash-appts-table');
  const recent = [...appointments].reverse().slice(0, 5);
  if (!recent.length) {
    tbody.innerHTML = '<tr><td colspan="4" style="text-align:center;color:var(--gray-mid);padding:24px">No appointments yet.</td></tr>';
    return;
  }
  tbody.innerHTML = recent.map(a => `
    <tr>
      <td>${a.patient}</td>
      <td>${a.doctor}</td>
      <td>${a.date}</td>
      <td>${statusBadge(a.status)}</td>
    </tr>`).join('');
}

// ‚îÄ‚îÄ PATIENTS ‚îÄ‚îÄ
function addPatient() {
  const name = document.getElementById('p-name').value.trim();
  const age = document.getElementById('p-age').value;
  const phone = document.getElementById('p-phone').value.trim();
  if (!name || !age || !phone) { toast('‚ö†Ô∏è Please fill in all required fields!'); return; }
  pCounter++;
  patients.push({
    id: 'P' + pCounter,
    name, age,
    gender: document.getElementById('p-gender').value,
    phone,
    blood: document.getElementById('p-blood').value,
    status: document.getElementById('p-status').value,
    address: document.getElementById('p-address').value
  });
  save(); closeModal('modal-patient'); renderPatients();
  ['p-name','p-age','p-phone','p-address'].forEach(id => document.getElementById(id).value = '');
  toast('‚úÖ Patient added successfully!');
}

function renderPatients() {
  const q = document.getElementById('patient-search').value.toLowerCase();
  const filtered = patients.filter(p => p.name.toLowerCase().includes(q) || p.id.toLowerCase().includes(q));
  const tbody = document.getElementById('patients-table');
  if (!filtered.length) {
    tbody.innerHTML = '<tr><td colspan="8" style="text-align:center;color:var(--gray-mid);padding:24px">No patients found.</td></tr>';
    return;
  }
  tbody.innerHTML = filtered.map(p => `
    <tr>
      <td><b>${p.id}</b></td>
      <td>${p.name}</td>
      <td>${p.age}</td>
      <td>${p.gender}</td>
      <td>${p.phone}</td>
      <td><span class="badge badge-red">${p.blood}</span></td>
      <td>${statusBadge(p.status)}</td>
      <td>
        <button class="btn btn-outline btn-sm" onclick="deleteRecord('patients','${p.id}','P')">üóë Delete</button>
      </td>
    </tr>`).join('');
}

// ‚îÄ‚îÄ APPOINTMENTS ‚îÄ‚îÄ
function addAppointment() {
  const patient = document.getElementById('a-patient').value.trim();
  const doctor = document.getElementById('a-doctor').value.trim();
  const date = document.getElementById('a-date').value;
  const time = document.getElementById('a-time').value;
  if (!patient || !doctor || !date || !time) { toast('‚ö†Ô∏è Please fill in all required fields!'); return; }
  aCounter++;
  appointments.push({
    id: 'A' + aCounter,
    patient, doctor, date, time,
    reason: document.getElementById('a-reason').value,
    status: 'Scheduled'
  });
  save(); closeModal('modal-appt'); renderAppointments(); updateDashboard();
  ['a-patient','a-doctor','a-date','a-time','a-reason'].forEach(id => document.getElementById(id).value = '');
  toast('‚úÖ Appointment booked!');
}

function renderAppointments() {
  const q = document.getElementById('appt-search').value.toLowerCase();
  const filtered = appointments.filter(a =>
    a.patient.toLowerCase().includes(q) || a.doctor.toLowerCase().includes(q)
  );
  const tbody = document.getElementById('appts-table');
  if (!filtered.length) {
    tbody.innerHTML = '<tr><td colspan="8" style="text-align:center;color:var(--gray-mid);padding:24px">No appointments found.</td></tr>';
    return;
  }
  tbody.innerHTML = [...filtered].reverse().map(a => `
    <tr>
      <td><b>${a.id}</b></td>
      <td>${a.patient}</td>
      <td>${a.doctor}</td>
      <td>${a.date}</td>
      <td>${a.time}</td>
      <td>${a.reason || '‚Äî'}</td>
      <td>
        <select onchange="updateApptStatus('${a.id}', this.value)" style="padding:6px 10px;border-radius:8px;border:1.5px solid #dce6f4;font-size:0.9rem;">
          ${['Scheduled','Completed','Cancelled'].map(s => `<option ${a.status===s?'selected':''}>${s}</option>`).join('')}
        </select>
      </td>
      <td><button class="btn btn-outline btn-sm" onclick="deleteRecord('appointments','${a.id}','A')">üóë</button></td>
    </tr>`).join('');
}

function updateApptStatus(id, status) {
  const a = appointments.find(x => x.id === id);
  if (a) { a.status = status; save(); toast('Status updated!'); }
}

// ‚îÄ‚îÄ STAFF ‚îÄ‚îÄ
function addStaff() {
  const name = document.getElementById('s-name').value.trim();
  if (!name) { toast('‚ö†Ô∏è Please enter a name!'); return; }
  sCounter++;
  staff.push({
    id: 'S' + sCounter,
    name,
    role: document.getElementById('s-role').value,
    dept: document.getElementById('s-dept').value,
    phone: document.getElementById('s-phone').value,
    available: document.getElementById('s-avail').value
  });
  save(); closeModal('modal-staff'); renderStaff(); updateDashboard();
  ['s-name','s-phone'].forEach(id => document.getElementById(id).value = '');
  toast('‚úÖ Staff member added!');
}

function renderStaff() {
  const q = document.getElementById('staff-search').value.toLowerCase();
  const filtered = staff.filter(s =>
    s.name.toLowerCase().includes(q) || s.dept.toLowerCase().includes(q) || s.role.toLowerCase().includes(q)
  );
  const tbody = document.getElementById('staff-table');
  if (!filtered.length) {
    tbody.innerHTML = '<tr><td colspan="7" style="text-align:center;color:var(--gray-mid);padding:24px">No staff found.</td></tr>';
    return;
  }
  tbody.innerHTML = filtered.map(s => `
    <tr>
      <td><b>${s.id}</b></td>
      <td>${s.name}</td>
      <td>${s.role}</td>
      <td>${s.dept}</td>
      <td>${s.phone || '‚Äî'}</td>
      <td>${statusBadge(s.available)}</td>
      <td><button class="btn btn-outline btn-sm" onclick="deleteRecord('staff','${s.id}','S')">üóë</button></td>
    </tr>`).join('');
}

// ‚îÄ‚îÄ BILLING ‚îÄ‚îÄ
function addBill() {
  const patient = document.getElementById('b-patient').value.trim();
  const amount = document.getElementById('b-amount').value;
  if (!patient || !amount) { toast('‚ö†Ô∏è Please fill in all required fields!'); return; }
  bCounter++;
  const date = document.getElementById('b-date').value || new Date().toISOString().split('T')[0];
  billing.push({
    id: 'B' + bCounter,
    patient, date,
    services: document.getElementById('b-services').value || 'General Services',
    amount: Number(amount),
    status: document.getElementById('b-status').value
  });
  save(); closeModal('modal-bill'); renderBilling(); updateDashboard();
  ['b-patient','b-date','b-services','b-amount'].forEach(id => document.getElementById(id).value = '');
  toast('‚úÖ Bill created!');
}

function renderBilling() {
  const q = document.getElementById('bill-search').value.toLowerCase();
  const filtered = billing.filter(b => b.patient.toLowerCase().includes(q) || b.id.toLowerCase().includes(q));
  const tbody = document.getElementById('billing-table');
  if (!filtered.length) {
    tbody.innerHTML = '<tr><td colspan="7" style="text-align:center;color:var(--gray-mid);padding:24px">No billing records found.</td></tr>';
    return;
  }
  tbody.innerHTML = [...filtered].reverse().map(b => `
    <tr>
      <td><b>${b.id}</b></td>
      <td>${b.patient}</td>
      <td>${b.date}</td>
      <td>${b.services}</td>
      <td><b>‚Çπ${Number(b.amount).toLocaleString('en-IN')}</b></td>
      <td>${statusBadge(b.status)}</td>
      <td><button class="btn btn-outline btn-sm" onclick="deleteRecord('billing','${b.id}','B')">üóë</button></td>
    </tr>`).join('');
}

// ‚îÄ‚îÄ DELETE ‚îÄ‚îÄ
function deleteRecord(type, id) {
  if (!confirm('Are you sure you want to delete this record?')) return;
  if (type === 'patients') patients = patients.filter(x => x.id !== id);
  if (type === 'appointments') appointments = appointments.filter(x => x.id !== id);
  if (type === 'staff') staff = staff.filter(x => x.id !== id);
  if (type === 'billing') billing = billing.filter(x => x.id !== id);
  save();
  if (type === 'patients') renderPatients();
  if (type === 'appointments') renderAppointments();
  if (type === 'staff') renderStaff();
  if (type === 'billing') renderBilling();
  updateDashboard();
  toast('üóëÔ∏è Record deleted.');
}

// ‚îÄ‚îÄ INIT ‚îÄ‚îÄ
updateDashboard();
</script>
</body>
</html>
